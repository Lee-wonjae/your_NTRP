# Tennis Ball Detection Project

This project aims to develop an algorithm to detect relatively small and indistinct objects, such as tennis balls, in images and videos. The primary goal is to use this algorithm to measure the speed of a tennis ball from video footage.

## Project Overview

### Project Goals
- Develop an algorithm for detecting small and indistinct objects in images.
- Utilize this algorithm to measure the speed of tennis balls in video footage.

### Background
This project was initiated to address the challenge of measuring the speed of a tennis ball through video analysis.

## Problem Definition

1. **Data Selection**: What data will be used?
2. **Data Preprocessing**: How will the data be preprocessed?
3. **Training Data Generation**: How will the training data be generated?
4. **Labeling**: How will the data be labeled?
5. **Model Selection for Object Classification**: Which model will be used for object classification?
6. **Model Selection for Object Detection**: Which model will be used for object detection?

## Dataset

The dataset used for this project consists of highlight videos from the ATP finals, with a total size of 138MB and a duration of 8 minutes and 26 seconds.

### Data Preprocessing
- **Frame Extraction**: The video is divided into 11,063 frames for analysis.
- **Image Selection**: Frames containing tennis balls are selected using OpenCVâ€™s `compareHist` method to ensure the ball is prominently displayed.

### Training Data Generation and Labeling
- **Ball Images**: Using the `labelImg` tool, 340 XML files were created for labeling the tennis balls in the images.
- **Background Images**: Generated by masking out the tennis balls in the images and splitting into 30x30 segments, resulting in 133,632 background images.

## Models for Object Classification

1. **Model 1**: A basic binary classification CNN model with three convolution layers, three pooling layers, and a 0.5 dropout. The optimizer used is Adam, and the loss function is BCE.
2. **Model 2**: A pre-trained ResNet50 model. Due to the small image size, this model did not perform as well.
3. **Model 3**: Similar to Model 2, but with Focal Loss to address data imbalance. Performance was still suboptimal due to the small image size.
4. **Model 4**: A customized ResNet model for 30x30 images using Focal Loss, with significantly longer training times (6 hours per epoch).

## Object Detection Model

- **Two-Stage Model with Sliding Window**: Chosen for its accuracy with fixed-size images (30x30). The sliding window size matches the input size of the classification model, and the sliding step size is set to 10 to ensure the ball remains centered in the window.

## Evaluation and Future Plans

Despite achieving 96% accuracy for ball detection and 100% for background detection, the overall performance was suboptimal due to sensitivity to slight pixel variations. 

### Next Steps
- Increase the amount of quality data to improve model performance.
- Explore further applications, such as tracking the ball's trajectory, measuring speed, and predicting match outcomes.

## Repository Structure

- **data/**: Contains the dataset and preprocessed frames.
- **models/**: Contains the trained models and scripts for training.
- **scripts/**: Contains scripts for preprocessing, training, and evaluation.
- **notebooks/**: Jupyter notebooks for exploratory data analysis and model development.
